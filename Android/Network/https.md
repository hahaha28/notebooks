# Https

> 来自[这篇文章](https://mp.weixin.qq.com/s/DGIkZT26CBafJzpQgrqqdQ)

## 两种加密方式

Https 用到的加密方式有对称加密和非对称加密

* **对称加密**

  对称加密，二者使用的密钥相同，效率较高

* **非对称加密**

  非对称加密，密钥分公钥和私钥，效率较低

## Https的流程

**下文中的公钥和私钥是非对称加密中的，密钥是指对称加密的**

1. 服务器将自己的公钥等信息交给CA机构，CA机构制作其证书。
2. 客户端向CA机构申请获取服务器证书。
3. CA机构用自己的私钥加密证书并发给客户端。
4. 客户端用CA机构的公钥解密并得到证书，从而得到服务器的公钥。
5. 客户端随机生成密钥，并用服务器的公钥加密。
6. 客户端将加密后的密钥发给服务器。
7. 服务器用自己的私钥解密从而得到密钥。
8. 双方之后使用密钥做对称加密通信。

## 几个问题

### 1.Https是什么加密？

Https是对称加密和非对称加密相结合，因为对称加密的效率较高，但是对称加密的密钥无法直接传递，所以借助非对称加密，让二者可以协商对称加密的密钥。

### 2.为什么服务器要将公钥交给CA？

如果直接发给客户端，存在被篡改的风险，而CA机构也就那么几个，所以CA机构的公钥内置在操作系统中。CA用自身的私钥加密证书，用来证明发给客户端的证书是正确的。

### 3.如果攻击者向同一个CA申请了证书，并且对客户端申请的证书进行掉包？

如果攻击者知道客户端要向哪一个CA获取证书，那么攻击者可以也去申请一个证书，当客户端申请证书时，他用自己的证书进行调包，由于是同一个CA机构，所以客户端用CA的公钥解密时也能成功，但是证书中不仅有服务器的公钥，还有域名等信息用来辅助验证，所以无法造假。



