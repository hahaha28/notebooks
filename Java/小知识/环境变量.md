![你应该知道的 Windows 环境变量](http://img.inaction.fun/static/25639.jpeg)

# 你应该知道的 Windows 环境变量

> [转载自知乎](https://zhuanlan.zhihu.com/p/67726501)

## 简介

所谓 Windows 环境变量，指的是 Windows 指定操作系统工作环境的一些选项或属性参数。

学习环境变量不仅能让我们在学习编程时对配置环境变量了然于心，还可以避免系统错误，有效提高工作效率。

本文从定义、设置再到实例，全面解析环境变量，帮助你从入门到精通。

## 1. 环境变量的定义

环境变量是 Windows 系统中用来指定运行环境的一些参数，它包含了关于系统及当前登录用户的环境信息字符串。当用户运行某些程序时，系统除了会在当前文件夹中寻找某些文件外，还会到环境参数的默认路径中去查找程序运行时所需要的系统文件。因此，环境变量控制着程序的行为。

环境变量可分为用户变量和系统变量。其中用户变量只针对当前登录的用户生效，用户可以对其进行添加、修改或删除。同时，Windows 安装程序或某些应用程序也可定义这些变量。而系统变量由Windows 定义并应用到所有系统用户，无论以什么身份登录系统，系统变量值都是一样的。但是只有管理员才能添加、修改或删除，而普通用户则无法编辑。

重要系统变量含义和功能：

- ComSpec 变量：规定 [http://CMD.COM](https://link.zhihu.com/?target=http%3A//CMD.COM) 文件的位置。运行 [http://cmd.com](https://link.zhihu.com/?target=http%3A//cmd.com) 可直接打开 “命令提示符” 窗口。
- NUMBER_OF_PROCESSORS 变量：代表用户电脑中处理器的数量。
- OS 变量：表明用户的操作系统。
- Path 变量：规定操作系统在指定的文件路径中查看可执行文件。
- PathExt 变量：规定在 Path 变量中所指定的可执行文件的扩展名有哪些。
- PROCESSOR_ARCHITECTURE 变量：表明用户处理器的架构。
- PROCESSOR_IDENTIFIER 变量：表明用户处理器。
- PROCESSOR_LEVEL 变量：表明用户处理器的等级。
- PROCESSOR_REVISION 变量：表明用户处理器的版本。
- TEMP、TMP 变量：规定系统运行或安装程序时用来存储临时文件的目录。
- windir 变量：规定操作系统的系统目录的路径。

## 2. 设置环境变量

### 2.1 “环境变量” 窗口进行设置

右键点击此电脑 -> 属性 -> 高级系统设置 -> 高级 -> 环境变量打开如下图所示窗口。

![img](http://img.inaction.fun/static/15962.jpeg)

点击新建添加一个环境变量，点击编辑修改一个环境变量，变量名和变量值设置时，不要含有空格，也不要使用中文，多个路径之间使用; 分隔。通常情况下用户变量一经修改后会立即生效，而系统变量需要重启电脑后才能生效，对于正在运行的程序需要关闭后再重新运行，新设置才能生效。

### 2.2 MS-DOS 命令行进行设置

打开 DOS 命令行界面，输入 `set` 命令，即可查看所有环境变量，`set` 命令后加具体变量名称，便可查看特定环境变量值。如果要添加新的环境变量时只需要输入 `set xxx=yyy` 命令便可添加一个变量名为 xxx，值为 yyy 的环境变量。如果要删除一个已经存在的环境变量时，只需要输入 `set xxx=` 即可，= 后面不能有空格，具体操作如下图所示。在命令行设置的环境变量可以不用重启系统便能立即生效。

![img](http://img.inaction.fun/static/69942.jpeg)

## 3. 环境变量应用实例

### 3.1 快速访问文件

如果我们把一些重要的，“隐私“ 的文件存储在深层的文件夹中，但是要访问如此长的路径非常麻烦而且容易忘记。于是便可使用环境变量实现隐私文件的高效调用。

如下图所示我们 E 盘下创建了一个文件路径，并创建了一个文件 `ohMyRainbowPony.txt`，其中写着 This is my beloved rainbow pony，所以如何快速的找到我们心爱的彩虹小马呢？

![v2-c9246391621480b456895df7157e9895_1440w](http://img.inaction.fun/static/47466.jpg)

打开环境变量窗口，在用户变量处新建一个环境变量如下图所示：

![img](http://img.inaction.fun/static/58066.jpeg)

然后 Win+r 打开运行（会留下历史访问痕迹）或者在系统资源管理器窗口地址栏（不会留下历史访问痕迹），输入 `%MyBelovedPony%`。如下图所示就瞬间找到我们心爱的彩虹小马啦~

![img](http://img.inaction.fun/static/48422.jpeg)

除了自定义环境变量外，Windows 系统默认会使用特定环境变量，来调用一些特殊文件夹。比如：`%userprofile%`，`%Systemroot%`，`%temp%`，快去试试这些变量分别指向那些特殊文件夹吧！

### 3.2 通过运行快速启动应用和通过命令行运行可执行文件

### 3.2.1 运行中快速启动应用

e.g. 想要快速打开微信，便可以将微信安装目录下的 WeChat.exe 所在的目录路径添加 Path 环境变量中，在运行中输入微信或者 WeChat 便可快速启动微信啦。

### 3.2.2 命令行启动可执行程序

e.g. 我们用 go 语言编写了一个 `furyOfDany.go` 的源文件，使用 `go build` 编译生成可执行文件 `furyOfDany.exe` 后将其拷贝至下图文件夹：

![img](http://img.inaction.fun/static/23166.jpeg)

接下来在 Path 环境变量为该可执行文件添加一个文件路径，接着在命令行中运行命令 furyOfDany 便可得到如下图所示：

![img](http://img.inaction.fun/static/60320.jpeg)

### 3.3 删除虚拟设备和查看硬件设备信息

### 3.3.1 删除虚拟设备

在 Windows 系统资源很有限的情况下，不常用硬件设备，应该及时从系统中卸载。然而由于卸载方法不当，如设备驱动未卸载就将设备直接从主板移除，导致设备驱动文件残留在系统中，对应设备在设备管理器中仍然存在，只是处于隐藏状态，那么怎么才能彻底删除这些虚拟设备呢？

在环境变量窗口中的用户变量新建一个变量名为 `devmgr_show_nonpresent_devices`，变量值为 `1` 的环境变量。重启计算机打开设备管理器点击菜单栏查看 -> 显示隐藏的设备就可以看到虚拟设备了，单击右键卸载即删除成功。

### 3.3.2 查看硬件设备详细信息

在管理硬件设备时，我们有时需要查看设备的 GUID、硬件 ID、设备实例路径等属性信息，可是进入系统设备管理器窗口，打开目标硬件设备的属性对话框时，不包含这些特殊属性信息。

进入环境变量窗口，在系统变量下新建变量名为 `devmgr_show_details`，值为 `1` 的环境变量，重启计算机，进入设备管理器窗口，再次打开目标设备的属性对话框时，就能看到 “详细信息” 标签了，切换到对应标签设置页面，就能查看到设备的 GUID、硬件 ID、设备实例路径等若干项属性信息了。

## 4. 总结

通过以上的讲解我们了解了环境变量的定义，以及如何通过环境变量窗口和 DOS 命令行进行设置，并且通过实例掌握了环境变量的几种常用使用方法。环境变量的使用还包括调整临时目录，解决软件不能正常安装问题和解决恢复控制台进入任何目录的限制，这些就留待大家慢慢探索啦。

